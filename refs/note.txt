Chay thu tu install.bat
TLS.KEY: mat khau key KemDate

cd /opt/keycloak/conf
keytool -genkeypair -alias localhost -keyalg RSA -keysize 2048 -validity 365 -keystore server.keystore -dname "cn=Server Administrator,o=Acme,c=GB" -keypass secret -storepass secret
keytool -exportcert -alias localhost -file server.cer -keystore server.keystore -storepass secret
export KEYCLOAK_ADMIN=admin
export KEYCLOAK_ADMIN_PASSWORD=admin
export JAVA_OPTS_APPEND="-Djgroups.tcp.port=7600 -Djgroups.dns.query=keycloak"
/opt/keycloak/bin/kc.sh start --cache=ispn --cache-stack=kubernetes --db=postgres --db-url=jdbc:postgresql://postgresql-rw/app --db-username=app --db-password=secret99 --http-enabled=false --https-key-store-password=secret --hostname=localhost

keytool -importcert -alias server -keystore path/to/java/lib/security/cacerts -file conf/server.crt

openssl req -x509 -sha256 -nodes -days 365 -newkey rsa:2048 -keyout auth-tls.key -out auth-tls.crt -subj "/CN=auth.localtest.me/O=smartconsultor"

openssl req -subj '/CN=localhost/O=Keycloak./C=VN' -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem
kubectl create secret tls keycloak-tls-secret --cert certificate.pem --key key.pem

kubectl create secret tls auth-tls-secret --key auth-tls.key --cert auth-tls.crt
// kiem tra nhat ky tao pod cua kubelet
journalctl -u kubelet --since "20 minutes ago" | grep -i error | tail -n 10
journalctl -u kubelet -f
minikube ssh --node minikube-m02
ip addr show
uname -a
kubectl cluster-info dump
kubectl config get-clusters
kubectl config get-contexts
kubectl config current-context
kubectl config get-users
// kiem tra quyen cua user dang nhap
kubectl exec -it postgresql-1 -- whoami
kubectl exec -it postgresql-1 -- id postgres
kubectl exec -it postgresql-1 -- ls -ld /var/lib/postgresql

// cai dat olm
https://github.com/operator-framework/operator-lifecycle-manager/blob/master/doc/install/install.md

//ignesss
(Invoke-WebRequest -Uri "https://raw.githubusercontent.com/keycloak/keycloak-quickstarts/latest/kubernetes/keycloak-ingress.yaml").Content | `
ForEach-Object { $_ -replace "KEYCLOAK_HOST", "keycloak.$((minikube ip).ToString()).nip.io" } | `
kubectl create -f -

$minikubeIp = (minikube ip).ToString()
$KEYCLOAK_URL = "https://keycloak.$minikubeIp.nip.io"
Write-Output ""
Write-Output "Keycloak:                 $KEYCLOAK_URL"
Write-Output "Keycloak Admin Console:   $($KEYCLOAK_URL)/admin"
Write-Output "Keycloak Account Console: $($KEYCLOAK_URL)/realms/myrealm/account"
Write-Output ""


//without igness
$minikubeIp = (minikube ip).ToString()
$nodePort = (kubectl get services/keycloak -o go-template='{{(index .spec.ports 0).nodePort}}').ToString()
$KEYCLOAK_URL = "https://${minikubeIp}:${nodePort}"

Write-Output ""
Write-Output "Keycloak:                 $KEYCLOAK_URL"
Write-Output "Keycloak Admin Console:   $($KEYCLOAK_URL)/admin"
Write-Output "Keycloak Account Console: $($KEYCLOAK_URL)/realms/myrealm/account"
Write-Output ""


scp docker@172.27.150.141:/var/lib/minikube/certs/ca.crt .\minikube-ca.crt


// keycloak
cd /opt/keycloak/bin
./kcadm.sh config credentials --server https://localhost:8443 --realm master --user admin



./kc.sh build
/kc.sh start 

curl --cacert /tmp/server.crt -d "client_id=admin-cli" -d "username=admin" -d "password=admin" -d "grant_type=password" "https://keycloak/realms/master/protocol/openid-connect/token"
curl -H "Authorization: bearer eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIxXzM1Vi1KelpNSzlWMEtqVkdtV0o0MnVZblpua2VrRGc0S3JYd0xGTmdJIn0.eyJleHAiOjE3MTIwNTI4ODcsImlhdCI6MTcxMjA1MjgyNywianRpIjoiZTdhYjJlZmEtYmRiYS00N2Y1LWI1ZjctOTg3Mjc5OGFmYTlkIiwiaXNzIjoiaHR0cHM6Ly9sb2NhbGhvc3QvcmVhbG1zL21hc3RlciIsInN1YiI6IjlkYjM0N2M0LTlkMzQtNDQ3ZS1iNjJiLWYzOWY3ODI1YzRlNiIsInR5cCI6IkJlYXJlciIsImF6cCI6ImFkbWluLWNsaSIsInNlc3Npb25fc3RhdGUiOiJhYWZiNmQ0Yi1kYTk2LTQwYzAtOTA1Mi1kZGNlZTNkMjUxMjgiLCJhY3IiOiIxIiwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwic2lkIjoiYWFmYjZkNGItZGE5Ni00MGMwLTkwNTItZGRjZWUzZDI1MTI4IiwiZW1haWxfdmVyaWZpZWQiOmZhbHNlLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJhZG1pbiJ9.jCz0oEELXf63iGSC1qqTIXe3sF8XIb1dT3Sp4K8Km318kDRTRYnSnCleuepz00G4OHlTMcFCqdHLi_sWgcORbTS78zn4W9lpc1Ho0gBSroxUEsv-iSDVoUT2VMP4XZia2rA7gtVOplqaQ11YyKFqvOqJfqKt3a6d8sVLjxqnNVdSf_EInLDLDkV8LHRDJqZsP42n_oaMd3HIw1LLHTe9Uypusb13p9MJOCNOBNH8QjRzxj1mcArx6dIeh_xvpwDmqM12WHzQYJRFi7aoMp71xO414cdtPxl70Gu_lwKncj0ZL2O3DXsn9hzxm56gu2AlSTcasNas4_onrQD7mE0keg" "https://keycloak/admin/realms/master"


kubectl create -f https://operatorhub.io/install/keycloak-operator.yaml
kubectl apply -f https://raw.githubusercontent.com/keycloak/keycloak-k8s-resources/24.0.2/kubernetes/keycloaks.k8s.keycloak.org-v1.yml
kubectl apply -f https://raw.githubusercontent.com/keycloak/keycloak-k8s-resources/24.0.2/kubernetes/keycloakrealmimports.k8s.keycloak.org-v1.yml
kubectl apply -f https://raw.githubusercontent.com/keycloak/keycloak-k8s-resources/24.0.2/kubernetes/kubernetes.yml
openssl req -subj '/CN=localhost/O=Keycloak./C=VN' -newkey rsa:2048 -nodes -keyout key.pem -x509 -days 365 -out certificate.pem -config 'C:\Program Files\OpenSSL-Win64\bin\cnf\openssl.cnf'
kubectl create secret tls keycloak-tls-secret --cert certificate.pem --key key.pem
kubectl create secret generic keycloak-db-secret --from-literal=username=app --from-literal=password=secret99


kubectl create -f https://operatorhub.io/install/edp-keycloak-operator.yaml
helm repo add epamedp https://epam.github.io/edp-helm-charts/stable
helm repo update
helm search repo epamedp/keycloak-operator -l
helm install keycloak-operator epamedp/keycloak-operator --version 1.20.0 --namespace default --set name=keycloak-operator


cd /opt/keycloak/conf
/usr/lib/jvm/java-17-openjdk-17.0.10.0.7-2.el9.x86_64/bin/keytool -genkeypair -alias localhost -keyalg RSA -keysize 2048 -validity 365 -keystore server.keystore -dname "cn=Server Administrator,o=Acme,c=GB" -keypass secret -storepass secret
export KEYCLOAK_ADMIN=admin
export KEYCLOAK_ADMIN_PASSWORD=admin
export JAVA_OPTS_APPEND="-Djgroups.tcp.port=7600 -Djgroups.dns.query=keycloak"
/opt/keycloak/bin/kc.sh start --cache=ispn --cache-stack=kubernetes --db=postgres --db-url=jdbc:postgresql://postgresql-rw/app --db-username=app --db-password=secret99 --http-enabled=false --https-key-store-password=secret --hostname=localhost


kubectl create clusterrolebinding cluster-system-anonymous --clusterrole=cluster-admin --user=system:anonymous

kubectl exec -it ignite-0 -- bash
apk update
apk add nmap nmap-scripts
apk add curl
APISERVER=https://kubernetes.default.svc.cluster.local:443
SERVICEACCOUNT=/var/run/secrets/kubernetes.io/serviceaccount
NAMESPACE=$(cat ${SERVICEACCOUNT}/namespace)
TOKEN=$(cat ${SERVICEACCOUNT}/token)
CACERT=${SERVICEACCOUNT}/ca.crt
SERVICE_NAME=ignite
curl --cacert ${CACERT} --header "Authorization: Bearer ${TOKEN}" -X GET ${APISERVER}/api/v1/namespaces/${NAMESPACE}/endpoints/${SERVICE_NAME}

nmap --script ssl-enum-ciphers -p 443 kubernetes.default.svc.cluster.local

istioctl ps frontend-deployment-685c4cc477-ngsq6
istioctl proxy-config routes frontend-deployment-685c4cc477-ngsq6

apt/yum  update 
apt/yum  install net-tools
netstat -tuln


# google oauth2
https://accounts.google.com/.well-known/openid-configuration

#t·∫°o client_id tr√™n 
https://console.cloud.google.com/

#truy cap vao tr√¨nh duy·ªát
https://accounts.google.com/o/oauth2/v2/auth?scope=https://www.googleapis.com/auth/userinfo.profile&access_type=offline&include_granted_scopes=true&response_type=code&state=state_parameter_passthrough_value&redirect_uri=http://localhost&client_id=533670103-3iajdsvqgl70ampdmslspn6268gedbq6.apps.googleusercontent.com
https://accounts.google.com/o/oauth2/v2/auth?scope=openid&access_type=offline&include_granted_scopes=true&response_type=code&state=state_parameter_passthrough_value&redirect_uri=http://localhost&client_id=533670103-3iajdsvqgl70ampdmslspn6268gedbq6.apps.googleusercontent.com
#l·∫•y code d√°n v√†o 
curl -X POST -d "client_id=533670103-3iajdsvqgl70ampdmslspn6268gedbq6.apps.googleusercontent.com&client_secret=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&redirect_uri=http://localhost&grant_type=authorization_code&code=4%2F0AdLIrYemyit1jCU4nVL9jb4nm-LmZ73W0nxaiTrMnlz60ReboGJEGHEdo7v9uB5x0QsacQ" https://oauth2.googleapis.com/token

# l·∫•y th√¥ng tin user d·ª±a tr√™n access token
curl -H "Authorization: Bearer ya29.a0AXooCguVKiHbH56AoxPK_yN969H9D2BKSIufRS-FbiooN_JMAQiPGPn2LWJyszbqNIT_5hYmmNnRnipGZKunnS90ybPtvlVR-YSJRzbx3hU4mAr3_3j1xUHR-jPE5-mVUHvHXQ4ISQIKffUcP-meXoqYPRoeA-uMc8iqaCgYKARASARASFQHGX2Mi1-pt5Q7rMlGESZsT6UDPhg0171" https://www.googleapis.com/oauth2/v2/userinfo

# x√°c th·ª±c access token
curl -H "Authorization: Bearer ya29.a0AXooCguVKiHbH56AoxPK_yN969H9D2BKSIufRS-FbiooN_JMAQiPGPn2LWJyszbqNIT_5hYmmNnRnipGZKunnS90ybPtvlVR-YSJRzbx3hU4mAr3_3j1xUHR-jPE5-mVUHvHXQ4ISQIKffUcP-meXoqYPRoeA-uMc8iqaCgYKARASARASFQHGX2Mi1-pt5Q7rMlGESZsT6UDPhg0171" https://www.googleapis.com/oauth2/v3/certs
# lay thong tin tu id_token
https://oauth2.googleapis.com/tokeninfo?id_token=

# Thay c√°c gi√° tr·ªã d∆∞·ªõi ƒë√¢y b·∫±ng c√°c gi√° tr·ªã th·ª±c t·∫ø c·ªßa b·∫°n
CLIENT_ID="your_client_id"
CLIENT_SECRET="your_client_secret"
REFRESH_TOKEN="your_refresh_token"

# G·ª≠i y√™u c·∫ßu ƒë·ªïi refresh token th√†nh access token
curl -d "client_id=533670103-3iajdsvqgl70ampdmslspn6268gedbq6.apps.googleusercontent.com&client_secret=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&refresh_token=1//0e0egDRaBgaMpCgYIARAAGA4SNwF-L9Irqkggs5ftWRBVbfEHyD3aDjoHm0Eix6e353Si5922I2gITp3HU2-kQVoLxpqttAii59E&grant_type=refresh_token" https://oauth2.googleapis.com/token

#https://www.googleapis.com/oauth2/v1/certs
docker create --name pulsar apachepulsar/pulsar:3.2.3
docker cp standalone.conf pulsar:/pulsar/conf/standalone.conf
docker cp google_oauth2_certs.pem pulsar:/pulsar/conf/google_oauth2_certs.pem
docker commit pulsar pulsar:latest
docker rm pulsar
docker run -it --name pulsar -p 6650:6650 -p 8080:8080 pulsar:latest bin/pulsar standalone

openssl s_client -showcerts -connect www.googleapis.com:443 | openssl x509 -outform PEM | Out-File -FilePath google_certs.pem -Encoding ascii


# thay ƒë·ªïi max_map_count=65530
minikube ssh
sudo sysctl -w vm.max_map_count=524288
echo 'vm.max_map_count=262144' | sudo tee -a /etc/sysctl.conf
#login kibana
kubectl exec -it elasticsearch-d86b5b4b5-r2rfj -- bin/elasticsearch-create-enrollment-token -s kibana
kubectl exec -it kibana-b6f9985c6-lfwtz -- bin/kibana-verification-code


1. L·∫•y th√¥ng tin realm-public-key
ƒêƒÉng nh·∫≠p v√†o giao di·ªán qu·∫£n tr·ªã c·ªßa Keycloak.
Ch·ªçn realm m√† b·∫°n mu·ªën l·∫•y th√¥ng tin (v√≠ d·ª•: master).
Ch·ªçn Realm Settings t·ª´ menu b√™n tr√°i.
Ch·ªçn tab Keys.
·ªû m·ª•c Active, b·∫°n s·∫Ω th·∫•y danh s√°ch c√°c keys. Ch·ªçn RSA (th∆∞·ªùng l√† lo·∫°i m·∫∑c ƒë·ªãnh) v√† sao ch√©p gi√° tr·ªã c·ªßa Public Key. ƒê√¢y l√† gi√° tr·ªã realm-public-key.
2. L·∫•y th√¥ng tin resource (Client ID)
Trong giao di·ªán qu·∫£n tr·ªã c·ªßa Keycloak, ch·ªçn realm c·ªßa b·∫°n (v√≠ d·ª•: master).
Ch·ªçn Clients t·ª´ menu b√™n tr√°i.
Ch·ªçn client m√† b·∫°n mu·ªën l·∫•y th√¥ng tin (v√≠ d·ª•: 06bd4e91fadb).
Trong tab Settings, b·∫°n s·∫Ω th·∫•y tr∆∞·ªùng Client ID. ƒê√¢y l√† gi√° tr·ªã resource.
3. L·∫•y th√¥ng tin secret
Trong giao di·ªán qu·∫£n tr·ªã c·ªßa Keycloak, ch·ªçn realm c·ªßa b·∫°n (v√≠ d·ª•: master).
Ch·ªçn Clients t·ª´ menu b√™n tr√°i.
Ch·ªçn client m√† b·∫°n mu·ªën l·∫•y th√¥ng tin (v√≠ d·ª•: 06bd4e91fadb).
Ch·ªçn tab Credentials.
B·∫°n s·∫Ω th·∫•y gi√° tr·ªã Secret. ƒê√¢y l√† gi√° tr·ªã secret.


kubectl get pods --namespace kube-system -o json | jq '.items[] | {"name": .metadata.name, labels: .metadata.labels}'

kubectl get pods --all-namespaces -o json | jq -r '.items[] | 
{
    namespace: .metadata.namespace, 
    name: .metadata.name, 
    containers: .spec.containers[]
} | select(.namespace | contains(\"default\")) |
{
    name: .name,
    requestsCpu: .containers.resources.requests.cpu,
    requestsMemory: .containers.resources.requests.memory, 
    limitsCpu: .containers.resources.limits.cpu,
    limitsMemory: .containers.resources.limits.memory
}'

kubectl get pods --all-namespaces -o json | jq -r '.items[] | 
                                                   select(.metadata.namespace==\"default\") |
                                                   .metadata.namespace as $ns | 
                                                   .metadata.name as $pod | 
                                                   .spec.containers[] | 
                                                   \"\($ns) \($pod) \(.resources.requests.cpu // \"0\") \(.resources.requests.memory // \"0\") \(.resources.limits.cpu // \"0\") \(.resources.limits.memory // \"0\")\"'

kubectl top pods --all-namespaces --no-headers

[gateway] 19.07.2024 02:44:24.236 [vert.x-eventloop-thread-1] INFO  com.smartconsultor.cluster.GatewayVerticle - principal: 
{"access_token":"eyJhbGciOiJSUzI1NiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICJhVmN2Zm9rOWhXZnJEVmJmaHk4elI0emc0OVRsWjU3bHJidzAyMnI3TkRJIn0.eyJleHAiOjE3MjEzNTcxMDcsImlhdCI6MTcyMTM1NzA0NywiYXV0aF90aW1lIjoxNzIxMzU3MDQ3LCJqdGkiOiIwYjZiY2ZkZC1jYmU4LTQwMjQtYmQxOC03NGRhNzUxNWY4ZDUiLCJpc3MiOiJodHRwOi8va2V5Y2xvYWsvcmVhbG1zL21hc3RlciIsImF1ZCI6ImFjY291bnQiLCJzdWIiOiIyNDM5ZjEzNC1iZDEwLTQ1M2MtYWQ5MS00YWRiMGQ2MjhjN2UiLCJ0eXAiOiJCZWFyZXIiLCJhenAiOiJ0ZXN0Iiwic2Vzc2lvbl9zdGF0ZSI6IjAzZTg1ODM0LTI0MGUtNGM3Zi1iYWExLWUyOGQyNDExYzYzYiIsImFjciI6IjEiLCJhbGxvd2VkLW9yaWdpbnMiOlsiIl0sInJlYWxtX2FjY2VzcyI6eyJyb2xlcyI6WyJkZWZhdWx0LXJvbGVzLW1hc3RlciIsIm9mZmxpbmVfYWNjZXNzIiwidW1hX2F1dGhvcml6YXRpb24iXX0sInJlc291cmNlX2FjY2VzcyI6eyJ0ZXN0Ijp7InJvbGVzIjpbInBsYWNlX29yZGVycyJdfSwiYWNjb3VudCI6eyJyb2xlcyI6WyJtYW5hZ2UtYWNjb3VudCIsIm1hbmFnZS1hY2NvdW50LWxpbmtzIiwidmlldy1wcm9maWxlIl19fSwic2NvcGUiOiJwcm9maWxlIGVtYWlsIiwic2lkIjoiMDNlODU4MzQtMjQwZS00YzdmLWJhYTEtZTI4ZDI0MTFjNjNiIiwiZW1haWxfdmVyaWZpZWQiOnRydWUsIm5hbWUiOiJUcmFuIFR1YW4iLCJwcmVmZXJyZWRfdXNlcm5hbWUiOiJ0dWFudGEiLCJnaXZlbl9uYW1lIjoiVHJhbiIsImZhbWlseV9uYW1lIjoiVHVhbiIsImVtYWlsIjoidHVhbnRhMjAyMUBnbWFpbC5jb20ifQ.QYh0KJq-cmGnuv17SjTe0usmS_0HYpH2vMpbW_oh0B6tqyQnGWQnHn28g0NmMRp-uOZmcrCnF0kbAdViJ3MZEL9cuxbMCMMzv_4d97KD5KvzqbXivXL2yW5fTAXt2k2A3OoXuEhgpJNREBOfDJZYe0S03qW8kltohV8ShdSp2n6KGUEFO8YEF1pg-tO0VQ3hypRpQZhZ5m-LkH7qOt8_JMxk8KfIYsgGORHvyq2lVVaooLESsUbL7-MOyScO8CzNmu8fnJlB3AsHEV4zMQXehPBkItthTVpgKWgTsCl39wHgSaGaYxrzwtG-nA0bWTdRn-CVgbLmN9B4zj3Gm0Y5Dg"
,"expires_in":60
,"refresh_expires_in":1800
,"refresh_token":"eyJhbGciOiJIUzUxMiIsInR5cCIgOiAiSldUIiwia2lkIiA6ICIzNjAwZjYzMy1kMWUwLTQxNzctOTQ5MC1iMzVhZTc1MTcyYjQifQ.eyJleHAiOjE3MjEzNTg4NDcsImlhdCI6MTcyMTM1NzA0NywianRpIjoiMmJlYjAzZDItNTdjYi00YWY3LTk3MjgtOTcwOGQzNTY2N2JmIiwiaXNzIjoiaHR0cDovL2tleWNsb2FrL3JlYWxtcy9tYXN0ZXIiLCJhdWQiOiJodHRwOi8va2V5Y2xvYWsvcmVhbG1zL21hc3RlciIsInN1YiI6IjI0MzlmMTM0LWJkMTAtNDUzYy1hZDkxLTRhZGIwZDYyOGM3ZSIsInR5cCI6IlJlZnJlc2giLCJhenAiOiJ0ZXN0Iiwic2Vzc2lvbl9zdGF0ZSI6IjAzZTg1ODM0LTI0MGUtNGM3Zi1iYWExLWUyOGQyNDExYzYzYiIsInNjb3BlIjoicHJvZmlsZSBlbWFpbCIsInNpZCI6IjAzZTg1ODM0LTI0MGUtNGM3Zi1iYWExLWUyOGQyNDExYzYzYiJ9.LSPLf0YD1C8L6aOYoeeJhAQDMNllYnegSUl5xvM1yNU3vFSgx_rbFfuVUBE6XF_vu5eWTN9tMEYnUkXXpNRENQ"
,"token_type":"Bearer"
,"not-before-policy":0
,"session_state":"03e85834-240e-4c7f-baa1-e28d2411c63b"
,"scope":"profile email"}
[gateway] 19.07.2024 02:44:24.243 [vert.x-eventloop-thread-1] INFO  com.smartconsultor.cluster.GatewayVerticle - attributes: {
[gateway]   "iat" : 1721357047,
[gateway]   "exp" : 1721357107
[gateway] }

gi·∫£i m√£ access_token
{
  "alg": "RS256",
  "typ": "JWT",
  "kid": "aVcvvfok9hWfrDVbfhy8zR4zg49TLZ57lrbw022r7NDI"
}
{
  "exp": 1721357107,
  "iat": 1721357047,
  "auth_time": 1721357047,
  "jti": "0b6bcfdd-cbe8-4024-bd18-74da7515f8d5",
  "iss": "http://keycloak/realms/master",
  "aud": "account",
  "sub": "2439f134-bd10-453c-ad91-4adb0d628c7e",
  "typ": "Bearer",
  "azp": "test",
  "session_state": "03e85834-240e-4c7f-baa1-e28d2411c63b",
  "acr": "1",
  "allowed-origins": [
    ""
  ],
  "realm_access": {
    "roles": [
      "default-roles-master",
      "offline_access",
      "uma_authorization"
    ]
  },
  "resource_access": {
    "test": {
      "roles": [
        "place_orders"
      ]
    },
    "account": {
      "roles": [
        "manage-account",
        "manage-account-links",
        "view-profile"
      ]
    }
  },
  "scope": "profile email",
  "sid": "03e85834-240e-4c7f-baa1-e28d2411c63b",
  "email_verified": true,
  "name": "Tran Tuan",
  "preferred_username": "tuanta",
  "given_name": "Tran",
  "family_name": "Tuan",
  "email": "tuanta2021@gmail.com"
}



Port forwarding service/pulsar-grafana in namespace default, remote port 80 -> http://127.0.0.1:9080
Port forwarding service/superset in namespace default, remote port 8088 -> http://127.0.0.1:8088
Port forwarding service/gateway in namespace default, remote port 80 -> http://127.0.0.1:8080
Port forwarding service/grafana in namespace istio-system, remote port 3000 -> http://127.0.0.1:3000
Port forwarding service/kiali in namespace istio-system, remote port 20001 -> http://127.0.0.1:20001
Port forwarding deployment/gateway-deployment in namespace default, remote port 5006 -> http://127.0.0.1:5006
Port forwarding service/pulsar-pulsar-manager in namespace default, remote port 9527 -> http://127.0.0.1:9527
Port forwarding deployment/account-deployment in namespace default, remote port 5005 -> http://127.0.0.1:5005
Port forwarding service/pulsar-kube-prometheus-sta-prometheus in namespace default, remote port 9090 -> http://127.0.0.1:9090
Port forwarding service/tracing in namespace istio-system, remote port 80 -> http://127.0.0.1:16686
Port forwarding service/infinispan in namespace default, remote port 11222 -> http://127.0.0.1:11222
Port forwarding service/keycloak in namespace default, remote port 80 -> http://127.0.0.1:80

curl -X POST "https://auth.smartconsultor.com/realms/master/protocol/openid-connect/token" \
     --cacert /Users/cunkem/backend/gateway/src/main/resources/ca.crt \
     -H "Content-Type: application/x-www-form-urlencoded" \
     -d "client_id=smartconsultor" \
     -d "client_secret=whdFoyHiGV45aVB9vAUxjQskqGpJY98M" \
     -d "grant_type=password" \
     -d "username=admin" \
     -d "password=admin123"


drop database keycloak; 
(fail)
-->
SELECT pg_terminate_backend(pid)
FROM pg_stat_activity
WHERE datname = 'keycloak';

tk: tuanta2021@gmail.com tren deepseek
curl https://api.deepseek.com/chat/completions \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer sk-3468d56f5d054f949ad2ba51da6ef48d" \
  -d '{
        "model": "deepseek-chat",
        "messages": [
          {"role": "system", "content": "You are a helpful assistant."},
          {"role": "user", "content": "Hello!"}
        ],
        "stream": false
      }'

https://huggingface.co/deepseek-ai/DeepSeek-R1

https://coinmarketcap.com

aws iam simulate-principal-policy \
  --policy-source-arn arn:aws:iam::509735772100:user/tuantahp \
  --action-names "sns:Publish" "sns:CreateTopic" \
  --region us-east-1

https://www.ros.org

- Cookie (Alternative)
- Identity Provider Redirector (Alternative)
- browser with sms forms (Alternative)
  - Username Password Form (Required) 
  - Check Device (Conditional Flow)
    - Condition - User Configured (Required)
    - SMS Authenticator (Alternative)
- Device Authenticator (Required)

LAP TRINH FLUTTER
A. kien truc clean + dartx + equartable: 
- UI (Button login) g·ªçi Bloc.add(LoginPressed(...))
- Bloc g·ªçi LoginUseCase.call(LoginParams(...))
- UseCase g·ªçi AuthRepository.exchangeCodeForToken(code)
- Repository g·ªçi AuthRemoteDataSource.exchangeCodeForToken(...)
- RemoteDataSource th·ª±c hi·ªán g·ªçi Keycloak API
- K·∫øt qu·∫£ tr·∫£ v·ªÅ qua Either<Failure, UserModel>
‚úÖ 1 usecase ‚Üí 1 class ‚Üí ƒê√∫ng.
‚úÖ Nhi·ªÅu usecase c√≥ th·ªÉ d√πng chung 1 Repository (Interface).
‚úÖ RepositoryImpl c√≥ th·ªÉ d√πng chung cho nhi·ªÅu usecase.
‚úÖ RemoteDataSource n√™n theo "ch·ª©c nƒÉng module", kh√¥ng nh·∫•t thi·∫øt ph·∫£i chia nh·ªè.

B. Khi n√†o c·∫ßn equatable?
D√πng equatable khi...	              Kh√¥ng c·∫ßn khi...
L√†m v·ªõi State, Event trong Bloc	    Class ch·ªâ d√πng t·∫°m th·ªùi
D√πng l√†m Params cho UseCase	        Kh√¥ng c·∫ßn so s√°nh object
Vi·∫øt test (so s√°nh 2 object)	      -

C. Functional Programming trong Dart :
∆Øu ƒëi·ªÉm	                                     M√¥ t·∫£
‚úÖ Kh√¥ng d√πng try-catch tr√†n lan	            M√£ s·∫°ch, l·ªói ƒë∆∞·ª£c gom v·ªÅ t·∫ßng DataSource
‚úÖ X·ª≠ l√Ω l·ªói c√≥ c·∫•u tr√∫c	                    Kh√¥ng ph·∫£i ph√¢n t√≠ch Exception.runtimeType lung tung
‚úÖ T·∫ßng UI v√† Bloc g·ªçn g√†ng	                Ch·ªâ c·∫ßn .fold(...) ho·∫∑c .map(...)
‚úÖ D·ªÖ test	                                  Kh√¥ng c·∫ßn try, ch·ªâ ki·ªÉm tra Left/Right
‚úÖ Th·ªëng nh·∫•t	                              C·∫£ app ch·ªâ x·ª≠ l√Ω l·ªói 1 ki·ªÉu duy nh·∫•t (Failure)


D. Clean Architecture + dartz + mockito: 
- mock domain (usecase, repo)
- mock data (RepoImpl, remotedata)
- ntegration test ho·∫∑c mock http response (‚úÖ Test g√¨?	                üìå √ù nghƒ©a
                                            API tr·∫£ 200	              C√≥ decode JSON ƒë√∫ng kh√¥ng
                                            API l·ªói (401, 500...)	    C√≥ n√©m ServerException ƒë√∫ng kh√¥ng)

L·∫¨P TR√åNH BACKEND
1. K·∫øt c·∫•u t·ªïng c√°c microservice
smartconsultor-backend/
‚îú‚îÄ‚îÄ pom.xml                              <- Root parent POM
‚îú‚îÄ‚îÄ common/                              <- T√°i s·ª≠ d·ª•ng gi·ªØa c√°c service
‚îÇ   ‚îú‚îÄ‚îÄ common-core/                     <- Entities, ValueObjects, UseCase interfaces
‚îÇ   ‚îú‚îÄ‚îÄ common-utils/                    <- JWT utils, mappers, exceptions, logging
‚îÇ   ‚îú‚îÄ‚îÄ common-config/                   <- Config loader, Keycloak, Pulsar,...
‚îÇ   ‚îî‚îÄ‚îÄ pom.xml
‚îú‚îÄ‚îÄ user-service/                        <- M·ªôt microservice c·ª• th·ªÉ
‚îÇ   ‚îú‚îÄ‚îÄ domain/                          <- Entity + Use Case (pure Java)
‚îÇ   ‚îú‚îÄ‚îÄ infrastructure/                  <- Adapter: db, redis, kafka, etc.
‚îÇ   ‚îú‚îÄ‚îÄ application/                     <- UseCaseImpl, Service logic
‚îÇ   ‚îú‚îÄ‚îÄ interfaces/                      <- Controller, EventBus/WebSocket handler
‚îÇ   ‚îú‚îÄ‚îÄ main/                            <- Main Verticle, config
‚îÇ   ‚îî‚îÄ‚îÄ pom.xml
‚îú‚îÄ‚îÄ order-service/                       <- Microservice kh√°c
‚îÇ   ‚îî‚îÄ‚îÄ ...
‚îî‚îÄ‚îÄ notification-service/                <- Microservice kh√°c
    ‚îî‚îÄ‚îÄ ...
2. K·∫øt c·∫•u trong c·ªßa m·ªói Microservice
my-vertx-app/
‚îú‚îÄ‚îÄ app/                                # L·ªõp Application Layer (entry point)
‚îÇ   ‚îú‚îÄ‚îÄ MainVerticle.java               # Entry point c·ªßa ·ª©ng d·ª•ng
‚îÇ   ‚îú‚îÄ‚îÄ config/                         # ƒê·ªçc v√† parse config (t·ª´ env, file, system props...)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AppConfig.java
‚îÇ   ‚îî‚îÄ‚îÄ di/                             # Kh·ªüi t·∫°o DI (ho·∫∑c manual wiring)
‚îÇ       ‚îî‚îÄ‚îÄ Injector.java
‚îÇ
‚îú‚îÄ‚îÄ adapter/                            # L·ªõp Adapter Layer (Web / WebSocket / EventBus)
‚îÇ   ‚îú‚îÄ‚îÄ web/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ route/                      # ƒê·ªãnh nghƒ©a c√°c route HTTP
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AuthRoute.java
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ handler/                    # Handler cho HTTP request
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ AuthHandler.java
‚îÇ   ‚îú‚îÄ‚îÄ websocket/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ handler/                    # Handler WebSocket
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ChatSocketHandler.java
‚îÇ   ‚îî‚îÄ‚îÄ eventbus/
‚îÇ       ‚îî‚îÄ‚îÄ consumer/                   # Consumer cho EventBus
‚îÇ           ‚îî‚îÄ‚îÄ UserEventConsumer.java
‚îÇ
‚îú‚îÄ‚îÄ domain/                             # L·ªõp Domain Layer (business rules)
‚îÇ   ‚îú‚îÄ‚îÄ model/                          # Entity / Value Object
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ User.java
‚îÇ   ‚îú‚îÄ‚îÄ repository/                     # Repository interface
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserRepository.java
‚îÇ   ‚îî‚îÄ‚îÄ usecase/                        # Use case (business logic)
‚îÇ       ‚îî‚îÄ‚îÄ AuthenticateUserUseCase.java
‚îÇ
‚îú‚îÄ‚îÄ infrastructure/                     # L·ªõp Infra Layer (implementation c·ªßa service / repository)
‚îÇ   ‚îú‚îÄ‚îÄ persistence/                    # Giao ti·∫øp DB (Postgres, Mongo...)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ UserRepositoryImpl.java
‚îÇ   ‚îú‚îÄ‚îÄ service/                        # External service (Keycloak, Email...)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ KeycloakServiceImpl.java
‚îÇ   ‚îî‚îÄ‚îÄ util/                           # Helper, utility
‚îÇ       ‚îî‚îÄ‚îÄ JsonUtil.java
‚îÇ
‚îú‚îÄ‚îÄ docker/                             # Docker files
‚îÇ   ‚îú‚îÄ‚îÄ Dockerfile
‚îÇ   ‚îî‚îÄ‚îÄ .dockerignore
‚îÇ
‚îú‚îÄ‚îÄ skaffold/                           # Skaffold config (k8s CICD)
‚îÇ   ‚îú‚îÄ‚îÄ skaffold.yaml
‚îÇ   ‚îî‚îÄ‚îÄ k8s/
‚îÇ       ‚îî‚îÄ‚îÄ deployment.yaml
‚îÇ
‚îú‚îÄ‚îÄ resources/
‚îÇ   ‚îî‚îÄ‚îÄ application.yaml                # C·∫•u h√¨nh ·ª©ng d·ª•ng
‚îÇ
‚îú‚îÄ‚îÄ test/                               # Unit & Integration tests
‚îÇ   ‚îî‚îÄ‚îÄ domain/
‚îÇ       ‚îî‚îÄ‚îÄ usecase/
‚îÇ           ‚îî‚îÄ‚îÄ AuthenticateUserUseCaseTest.java
‚îÇ
‚îú‚îÄ‚îÄ pom.xml                             # Maven build config
‚îî‚îÄ‚îÄ README.md

4. Th∆∞ m·ª•c common:
- common-core/
  + BaseEntity.java, BaseUseCase.java
  + Custom Either<L, R> (n·∫øu kh√¥ng d√πng Vavr)
  + Common Result<T> object
- common-utils/
  + Exception: AppException, ServerException, BusinessException
  + JWT utils, Email utils, etc.
- cmmon-config/
  + ConfigLoader.java: ƒë·ªçc YAML, JSON, ENV
  + KeycloakClient.java
  + PulsarClientProvider.java
5. T·ªáp pom.xml cho root project:
<modules>
  <module>common/common-core</module>
  <module>common/common-utils</module>
  <module>common/common-config</module>
  <module>user-service</module>
  <module>order-service</module>
  <module>notification-service</module>
</modules>

6. Lu·ªìng x·ª≠ l√Ω 

Client ‚Üí /auth/login
  ‚Üì
MainVerticle ‚Üí AuthRoute ‚Üí AuthHandler
  ‚Üì
AuthenticateUserUseCase (domain logic)
  ‚Üì
UserRepository (interface) ‚Üí UserRepositoryImpl
  ‚Üì
KeycloakServiceImpl (HTTP call)
  ‚Üì
Tr·∫£ User entity ho·∫∑c l·ªói
  ‚Üë
AuthHandler tr·∫£ JSON v·ªÅ client


üß© DANH S√ÅCH Lƒ®NH V·ª∞C & AGENT

Lƒ©nh v·ª±c	            AI Agent ti√™u bi·ªÉu	                      M√¥ t·∫£
üõ† Product	          FeaturePlannerAI, FeedbackSynthAI	        Ph√¢n t√≠ch y√™u c·∫ßu, l·∫≠p roadmap
üí∏ Finance	          CashflowAI, ForecastAI, InvoiceBot	      D·ª± ƒëo√°n d√≤ng ti·ªÅn, l·∫≠p k·∫ø ho·∫°ch t√†i ch√≠nh
üë• Human Resource	    TalentScoutAI, EngagementAI	              Tuy·ªÉn d·ª•ng, ƒë√°nh gi√°, gi·ªØ ch√¢n nh√¢n vi√™n
üì£ Marketing	        SEOGeneratorAI, AdOptimizerAI	            T·ªëi ∆∞u n·ªôi dung, chi·∫øn d·ªãch qu·∫£ng c√°o
üîß Engineering	      CodeReviewerAI, DevMentorAI	              Review code, h·ªó tr·ª£ ki·∫øn tr√∫c, CI/CD
üõ† Operations	        KPITrackerAI, TaskOrchestratorAI	        T·ªëi ∆∞u quy tr√¨nh, theo d√µi hi·ªáu su·∫•t
‚öñ Legal&Compliance    ContractCheckerAI, PolicyUpdateAI	        Ki·ªÉm h·ª£p ƒë·ªìng, c·∫≠p nh·∫≠t ch√≠nh s√°ch
üõ° Security	          AccessControlAI, RiskPredictorAI	        Ph√¢n quy·ªÅn, ph√°t hi·ªán r·ªßi ro b·∫£o m·∫≠t
üìû Customer&Support	  AutoResponderAI, ChurnAlertAI	            T·ª± ƒë·ªông tr·∫£ l·ªùi, c·∫£nh b√°o m·∫•t kh√°ch
ü§ù Business Dev	      PartnerScanAI, DealMakerAI	              T√¨m ki·∫øm ƒë·ªëi t√°c, ƒë·ªÅ xu·∫•t th∆∞∆°ng v·ª•
üî¨ R&D	              TechRadarAI, PrototypeAdvisorAI	          Ph√¢n t√≠ch xu h∆∞·ªõng, t∆∞ v·∫•n s·∫£n ph·∫©m th·ª≠ nghi·ªám

üß† MCP CORE: Trung t√¢m ƒëi·ªÅu ph·ªëi
Message Bus/Event Router: (CrewAI / LangGraph / Apache Pulsar)
Shared Memory Store: Vector DB (Chroma, Weaviate) ƒë·ªÉ l∆∞u context, memory c·ªßa c√°c agent
Orchestration Layer: Qu·∫£n l√Ω flow ƒëa agent, retry/fallback, circuit breaker
Identity & Security Layer: G·∫Øn vai tr√≤, ph√≤ng ban, quy·ªÅn truy c·∫≠p cho m·ªói agent

üåÄFLOW M·∫™U: Feature t·ª´ kh√°ch h√†ng ‚Üí Ph√°t tri·ªÉn
FeedbackSynthAI (Product) ph√¢n t√≠ch feedback ‚Üí x√°c ƒë·ªãnh t√≠nh nƒÉng.
ForecastAI (Finance) ∆∞·ªõc t√≠nh chi ph√≠ ‚Üí tr·∫£ v·ªÅ quy·∫øt ƒë·ªãnh kh·∫£ thi.
DevMentorAI + CodeReviewerAI (Engineering) b·∫Øt ƒë·∫ßu build.
AdOptimizerAI (Marketing) chu·∫©n b·ªã chi·∫øn d·ªãch gi·ªõi thi·ªáu t√≠nh nƒÉng.
CustomerSuccessAI ki·ªÉm tra ph·∫£n h·ªìi sau khi tri·ªÉn khai.
To√†n b·ªô log/insight l∆∞u t·∫°i shared memory, d√πng cho hu·∫•n luy·ªán l·∫°i m√¥ h√¨nh.


#0 ph√¢n v√πng
user-123
pre-domain 
pre-pod (thu·ªôc domain)
pre-topic (thu√¥c pre-pod)
cur-domain 
cur-pod
cur-topic

# 1. T·∫≠p h·ª£p c√°c thi·∫øt b·ªã
user:user-123:devices => [web-uuid-1, ios-uuid-2, android-uuid-3]

# 2. V·ªõi m·ªói device, l√† c√°c k·∫øt n·ªëi:
ws:user-123:web-uuid-1 => {
  0: conn-web-uuid-1-0,
  1: conn-web-uuid-1-1,
  ...
}

ws:user-123:ios-uuid-2 => {
  0: conn-ios-uuid-2-0,
  1: conn-ios-uuid-2-1,
}
# 3. v·ªõi m·ªói connectionIndex c√≥ 1 seqid
seq:user-123:web-uuid-1:0 => 1503
seq:user-123:web-uuid-1:1 => 1543
seq:user-123:ios-uuid-2:0 => 998

#4. 
ack:user-123:web-uuid-1:0 => true
ack:user-123:web-uuid-1:1 => false
conn:user-123:web-uuid-1:0 => <timestamp>

#5.
client g·ª≠i:
{
  deviceId: "web-uuid-1",
  lastKnownConnectionIds: [
    { index: 0, seqId: 1543 },
    { index: 1, seqId: 1503 }
  ]
}


FLINK: 

| **Lo·∫°i state**              | **M√¥ t·∫£**                                             | **Lo·∫°i**                    |
| --------------------------- | ----------------------------------------------------- | --------------------------- |
| `ValueState<T>`             | L∆∞u m·ªôt gi√° tr·ªã duy nh·∫•t cho m·ªói key                  | Keyed                       |
| `ListState<T>`              | L∆∞u m·ªôt danh s√°ch c√°c ph·∫ßn t·ª≠                         | Keyed / Operator¬π           |
| `ReducingState<T>`          | T·ªïng h·ª£p d·ªØ li·ªáu li√™n t·ª•c qua h√†m `reduce()`          | Keyed                       |
| `AggregatingState<IN, OUT>` | T·ªïng h·ª£p qua `aggregate()` tr·∫£ v·ªÅ k·∫øt qu·∫£ m·ªõi         | Keyed                       |
| `MapState<K, V>`            | L∆∞u tr·ªØ map key ‚Üí value ri√™ng cho t·ª´ng key            | Keyed                       |
| **Broadcast State**         | L∆∞u tr·∫°ng th√°i chung ƒë∆∞·ª£c broadcast ƒë·∫øn m·ªçi subtask   | Operator (Broadcast stream) |
| **Operator State**          | Tr·∫°ng th√°i g·∫Øn v·ªõi to√†n operator, kh√¥ng chia theo key | Operator                    |


| Class                    | State ki·ªÉu g√¨     | C√≥ c·∫ßn `keyBy()`? | D√πng ƒë·ªÉ l√†m g√¨                              |
| ------------------------ | ----------------- | ----------------- | ------------------------------------------- |
| `KeyedProcessFunction`   | Keyed State       | ‚úÖ C√≥              | X·ª≠ l√Ω theo t·ª´ng key ri√™ng bi·ªát              |
| `KeyedCoProcessFunction` | Keyed State       | ‚úÖ C√≥              | Join/merge 2 stream theo key                |
| `CheckpointedFunction`   | Operator State    | ‚ùå Kh√¥ng c·∫ßn       | X·ª≠ l√Ω source/custom logic v·ªõi state         |
| `RichSourceFunction`     | Kh√¥ng c√≥/t√πy ch·ªçn | ‚ùå Kh√¥ng c·∫ßn       | Source t√πy ch·ªânh, m·ªü r·ªông th√¥ng tin context |

KeyedProcessFunction.java: 

stream
  .keyBy(event -> event.userId)
  .process(new KeyedProcessFunction<String, Event, String>() {

    private ValueState<Integer> count;

    @Override
    public void open(Configuration parameters) {
      count = getRuntimeContext().getState(
        new ValueStateDescriptor<>("count", Integer.class)
      );
    }

    @Override
    public void processElement(Event value, Context ctx, Collector<String> out) throws Exception {
      Integer current = count.value();
      if (current == null) current = 0;
      count.update(current + 1);
      out.collect("User " + value.userId + " has " + (current + 1) + " events");
    }
  });

üß† Key point:
State ·ªü ƒë√¢y l√† ValueState, v√† ƒë∆∞·ª£c l∆∞u ri√™ng theo t·ª´ng userId (v√¨ c√≥ keyBy()).

KeyedCoProcessFunction.java

stream1
  .keyBy(x -> x.userId)
  .connect(stream2.keyBy(y -> y.userId))
  .process(new KeyedCoProcessFunction<String, EventA, EventB, String>() {

    private ValueState<EventA> stateA;

    @Override
    public void open(Configuration parameters) {
      stateA = getRuntimeContext().getState(
        new ValueStateDescriptor<>("a", EventA.class)
      );
    }

    @Override
    public void processElement1(EventA a, Context ctx, Collector<String> out) throws Exception {
      stateA.update(a);
    }

    @Override
    public void processElement2(EventB b, Context ctx, Collector<String> out) throws Exception {
      EventA a = stateA.value();
      if (a != null) {
        out.collect("Join: " + a + " and " + b);
      }
    }
  });

üß† Key point:
K·∫øt h·ª£p 2 stream ƒë√£ keyBy(userId).
State v·∫´n l√† Keyed State, ri√™ng cho m·ªói userId.  

CheckpointedFunction.java

public class MyStatefulSource implements SourceFunction<String>, CheckpointedFunction {

  private volatile boolean isRunning = true;
  private ListState<String> state;
  private List<String> buffer = new ArrayList<>();

  @Override
  public void run(SourceContext<String> ctx) throws Exception {
    while (isRunning) {
      // simulate data
      String value = UUID.randomUUID().toString();
      buffer.add(value);
      synchronized (ctx.getCheckpointLock()) {
        ctx.collect(value);
      }
      Thread.sleep(1000);
    }
  }

  @Override
  public void snapshotState(FunctionSnapshotContext context) throws Exception {
    state.clear();
    for (String item : buffer) {
      state.add(item);
    }
  }

  @Override
  public void initializeState(FunctionInitializationContext context) throws Exception {
    state = context.getOperatorStateStore().getListState(
      new ListStateDescriptor<>("buffer", String.class)
    );
    for (String item : state.get()) {
      buffer.add(item);
    }
  }

  @Override
  public void cancel() {
    isRunning = false;
  }
}

üß† Key point:
Kh√¥ng c√≥ keyBy ‚Üí d√πng Operator State.
D√πng ƒë·ªÉ checkpoint n·ªôi dung buffer khi l√†m source t√πy ch·ªânh.


RichSourceFunction.java

public class MyRichSource extends RichSourceFunction<String> {

  @Override
  public void open(Configuration parameters) {
    System.out.println("Task index: " + getRuntimeContext().getIndexOfThisSubtask());
  }

  @Override
  public void run(SourceContext<String> ctx) {
    ctx.collect("Hello from subtask");
  }

  @Override
  public void cancel() {
  }
}

üß† Key point:
RichSourceFunction cho ph√©p b·∫°n access context nh∆∞ task index, metrics, state, config.
K·∫øt h·ª£p t·ªët v·ªõi CheckpointedFunction n·∫øu b·∫°n c·∫ßn stateful source.
